<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Marketo</title>
  <link href="https://www.contentstack.com/sdks/contentstack-ui-extensions/dist/latest/ui-extension-sdk.css" rel="stylesheet" type="text/css" media="all">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
<!--   <link href="./style.css" rel="stylesheet" type="text/css" media="all">
 -->  <script src="https://www.contentstack.com/sdks/contentstack-ui-extensions/dist/latest/ui-extension-sdk.js"></script>
  <script type="text/javascript" src="https://code.jquery.com/jquery-1.x-git.min.js"></script>
</head>

<body>
    <select class="form-control" id="form-select-field" style="display: none;">
          <option value="">-- Select a form --</option>
    </select>
  <script>
"use strict";var _createClass=function(){function o(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,n,t){return n&&o(e.prototype,n),t&&o(e,t),e}}();function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var extensionField=void 0,selectField=void 0,marketo={};function domChangeListner(t){selectField.on("change",function(){var n=$("#form-select-field").val(),e=t.find(function(e){return e.id.toString()===n});extensionField.field.setData(e)})}function render(e){console.log("forms",e);var n=extensionField&&extensionField.field&&extensionField.field.getData()?extensionField.field.getData():{},t=$("select option:contains('-- Select a form --')"),o=n.id;e.forEach(function(e){var n=$("<option></option>").attr("value",e.id).text(e.name);e.id===o&&(console.log("inside",e),n.attr("selected","selected")),selectField.append(n)}),t.attr("disabled","disabled"),o||t.attr("selected","selected"),selectField.show(),domChangeListner(e)}var Marketo=function(){function o(e){var n=e.url,t=e.folder;_classCallCheck(this,o),this.url=n,this.folder=t}return _createClass(o,[{key:"getForms",value:function(){var o=this;return new Promise(function(t,n){var e=""+o.url;return o.folder&&(e=e+"?folder="+o.folder),fetch(e,{method:"GET"}).then(function(e){return e.json()}).then(function(e){var n=[{id:400,name:"none"}];return n=n.concat(e),t(n)}).catch(function(e){n(e)})})}}]),o}();$(document).ready(function(){selectField=$("#form-select-field"),ContentstackUIExtension.init().then(function(e){(marketo=new Marketo((extensionField=e).config)).getForms().then(function(e){console.log(e),render(e)}),extensionField.window.enableAutoResizing()})});
</script>
</body>

</html>